## XSS(Cross-Site Scripting)란?

신뢰할 수 있는 웹사이트에 악성 스크립트를 삽입하여 사용자 브라우저에서 실행되게 하는 공격. 결과적으로 쿠키 탈취, 세션 하이재킹, 피싱 등이 가능해짐.

## XSS 유형

- **저장형(Stored) XSS**: 악성 스크립트가 서버에 저장되어, 다른 사용자가 페이지를 방문할 때 자동 실행됨.
- **반사형(Reflected) XSS**: URL 파라미터 등으로 전달된 스크립트가 응답에 포함되어 즉시 실행됨.
- **DOM 기반 XSS**: 클라이언트 측 스크립트가 DOM을 동적으로 조작하는 과정에서 발생.

## 방어 전략(프론트엔드 관점)

- **입력 검증(Input Validation)**: 기대 형식/길이/화이트리스트 기반 검증 수행.
- **출력 이스케이프(Output Escaping)**: HTML 컨텍스트에 특수문자 이스케이프 처리.
- **안전한 DOM API 사용**: `element.innerHTML` 대신 `element.textContent` 또는 속성 전용 API 사용.
- **신뢰 불가 HTML 정화**: 사용자 제공 HTML은 라이브러리로 sanitize 처리(DOMPurify 등).
- **CSP(Content-Security-Policy)**: 신뢰된 소스만 스크립트/리소스 실행 허용.
- **HttpOnly 쿠키**: 자바스크립트에서 쿠키 접근을 차단해 탈취 위험 완화.

### 안전한 렌더링 예시

```js
// ❌ 잘못된 방법
element.innerHTML = userInput;

// ✅ 올바른 방법: 자동 이스케이프
element.textContent = userInput;
```

### HTML이 필요한 경우(DOMPurify)

```js
import DOMPurify from "dompurify";

element.innerHTML = DOMPurify.sanitize(userInput);
```

### CSP 설정 예시

HTTP 헤더로 설정하는 것이 권장되나, 메타 태그로도 설정 가능.

```html
<!-- HTTP 헤더 또는 메타 태그로 설정 -->
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://trusted-cdn.com;" />
```

### 요약

- **핵심**: 입력은 검증하고, 출력은 컨텍스트에 맞게 이스케이프.
- **DOM 조작**: `innerHTML` 지양, `textContent`/속성 API 선호.
- **추가 방어**: DOMPurify + CSP + HttpOnly 쿠키 병행.
