## Execution Context (실행 컨텍스트)

자바스크립트에서 코드가 "어떤 환경에서, 어떤 규칙으로" 실행되는지를 정의하고 관리하는 추상적 메커니즘. 런타임 동안 생성·파괴되며, 스택(Stack)으로 관리된다.

### 핵심 한 줄 요약

실행 컨텍스트는 스코프, 변수/함수 선언, this 바인딩 등 "실행에 필요한 모든 문맥"의 스냅샷이다.

---

### 왜 필요한가

- **코드 격리·조합**: 전역과 함수별로 독립된 실행 환경 제공
- **이름 해석**: 스코프 체인을 통해 식별자(변수/함수)를 올바르게 찾음
- **this 결정을 일관화**: 호출 방식에 따른 참조 대상을 체계적으로 결정

---

### 종류

- **전역 실행 컨텍스트**: 자바스크립트 프로그램 시작 시 1개 생성, 종료 시까지 유지
- **함수 실행 컨텍스트**: 함수 호출마다 새로 생성, 종료 시 제거
- (참고) eval 컨텍스트는 특수 케이스로 실무에서 거의 사용하지 않음

컨텍스트는 호출될 때마다 스택의 맨 위에 쌓이고, 종료 시 스택에서 빠진다.

---

### 구성 요소(개념 정렬)

- **변수 환경(Variable Environment) / 환경 레코드(Environment Record)**
  - 현재 컨텍스트의 변수, 함수 선언, 매개변수 등의 바인딩을 저장
  - 전통 용어로는 "변수 객체"로 불렸음
- **렉시컬 환경(Lexical Environment) / 스코프 체인**
  - 현재 컨텍스트와 외부(상위) 렉시컬 환경을 연결하여 식별자 검색 경로를 제공
- **this 바인딩(this binding)**
  - 현재 컨텍스트에서 `this`가 가리키는 대상에 대한 참조

---

### 생성 단계 → 실행 단계

1. **생성 단계 (Creation Phase)**
   - 스코프 체인 구성, `this` 결정
   - 선언문 처리: 함수 선언은 전체 바인딩, 변수는 선언만(초기화는 실행 단계)
2. **실행 단계 (Execution Phase)**
   - 코드가 위에서 아래로 실행되며 식별자 조회·값 대입·호출 수행

---

### this 바인딩 규칙 요약

- 전역 컨텍스트: 브라우저 `window`(strict 모드에선 `undefined`), Node는 `global`(모듈 스코프에서는 다름)
- 단순 함수 호출: strict 모드 `undefined`, 비 strict 모드 전역 객체
- 메서드 호출: 점(.)의 왼쪽 객체
- 생성자 호출: 새로 생성되는 인스턴스
- `call/apply/bind`: 명시적으로 지정한 객체
- 화살표 함수: 자신만의 `this` 없음, **상위 렉시컬 `this`**를 캡처

---

### 간단 예시

```js
// 전역 컨텍스트 생성
const x = 1;

function outer(y) {
  const z = 2;

  function inner() {
    // 식별자 검색: x(전역) → y(outer 매개변수) → z(outer 지역)
    return x + y + z; // 스코프 체인을 따라 찾는다
  }

  return inner();
}

outer(3); // 1 + 3 + 2 = 6
```

```js
// this 바인딩 예시
const obj = {
  value: 42,
  normal() {
    return this.value;
  },
  arrow: () => this && this.value,
};

obj.normal(); // 42 (obj)
obj.arrow(); // 상위 렉시컬 this(전역/모듈)에 따라 결과 달라짐
```

---

### 한눈에 보기

- **Execution Context = 스코프 + 바인딩(변수/함수) + this**
- **스택 기반**으로 전역 1개 + 함수 호출마다 1개 생성/파괴
- **생성 단계(호이스팅·this 결정) → 실행 단계(평가/실행)**
- **스코프 체인**으로 이름 해석, **호출 방식**으로 `this` 결정, **화살표 함수**는 상위 `this` 캡처

---

### 용어 대응

- 실행 컨텍스트: Execution Context
- 스코프 체인: Scope Chain / Lexical Environment
- 변수 객체(환경 레코드): Variable Environment / Environment Record
- this 바인딩: this binding
  실행 컨텍스트에 대해서 설명해주세요
  프론트엔드와 관련된 질문이에요.
  실행 컨텍스트는 자바스크립트에서 코드가 실행되는 환경을 의미합니다. 자바스크립트 엔진이 코드를 실행할 때, 그 코드가 실행될 때의 환경을 정의하고 관리하기 위해 존재하는 것이 실행 컨텍스트입니다.

실행 컨텍스트는 크게 전역 실행 컨텍스트와 함수 실행 컨텍스트로 나눌 수 있습니다.

전역 실행 컨텍스트는 자바스크립트가 처음 실행될 때 생성되는 컨텍스트입니다. 이 전역 컨텍스트는 프로그램이 종료될 때까지 유지되며, 전역에 선언된 변수나 함수가 모두 포함됩니다. 전역 컨텍스트에서 선언된 변수와 함수는 프로그램 내 어디서든 접근이 가능합니다.

기본적으로 자바스크립트는 싱글 스레드이기 때문에, 전역 실행 컨텍스트는 1개만 존재합니다.

함수 실행 컨텍스트는 함수가 호출될 때마다 생성 되는 컨텍스트를 의미합니다. 각 함수는 자신만의 실행 컨텍스트를 가지며, 이 컨텍스트 내에서 선언된 변수와 함수는 해당 함수 내에서만 유효합니다. 함수가 종료되면 그 실행 컨텍스트도 함께 사라집니다.

실행 컨텍스트는 어떤 구성 요소로 이루어져 있나요? 🤔
실행 컨텍스트는 크게 변수 객체, 스코프 체인, this 라는 구성 요소로 이루어져 있습니다.

첫째, 변수 객체란 실행 컨텍스트 내에서 사용되는 변수와 함수 선언을 저장하는 공간입니다. 전역 컨텍스트에서는 전역 객체가 변수 객체의 역할을 하고, 함수 컨텍스트에서는 활성 객체가 변수와 매개변수를 관리합니다.

둘째, 스코프 체인입니다. 현재 실행 중인 컨텍스트와 외부 렉시컬 환경의 연결을 유지합니다. 변수를 참조할 때 현재 컨텍스트에서 찾지 못하면 외부 환경으로 범위를 넓혀가며 변수를 찾습니다.

마지막으로, this입니다. this는 실행 컨텍스트에 따라 참조하는 객체가 달라집니다. 전역 컨텍스트에서는 this가 전역 객체를 가리키며, 함수 컨텍스트에서는 함수 호출 방법에 따라 달라집니다.

실행 컨텍스트는 이러한 구성 요소를 바탕으로 자바스크립트 코드가 실행되는 동안의 환경을 관리하고, 코드 실행 시 변수의 유효 범위나 함수 호출의 맥락을 결정 짓습니다.
